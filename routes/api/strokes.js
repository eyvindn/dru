var express = require('express');
var router = express.Router();

var passport = require('passport')
  , FacebookStrategy = require('passport-facebook').Strategy;

var nano = require('nano')('http://localhost:5984');
var db_name = "dkyk";
var db = nano.use(db_name);


/* GET users listing. */
router.get('/all', function(req, res) {
	//if (!req.user){
	//	res.send("FAIL");
	//} else {
		db.view('strokes/', 'all', function(err, body) {
			if (!err) {
				res.send(body);
			} else {
				res.send("FAILED: " + err);
			}
		})
	//}
});

/* GET users listing. */
router.get('/since/:id', function(req, res) {
	//if (!req.user){
	//	res.send("FAIL");
	//} else {
		db.view('strokes/', 'all', {startkey: parseInt(req.params.id)}, function(err, body) {
			if (!err) {
				res.send(body);
			} else {
				res.send("FAILED: " + err);
			}
		})
	//}
});

/* GET users listing. */
router.get('/clear', function(req, res) {
	//if (!req.user){
	//	res.send("FAIL");
	//} else {
		nano.db.destroy('dkyk', function() {
  			// create a new database
  			nano.db.create('dkyk', function() {
  				var db = nano.use(db_name);

db.bulk({"docs":[{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-436,-331.5],[0,0],[0,75.23316]],[[-403,-176.5],[-46.19593,-65.01649],[7.13012,10.03498]],[[-375,-150.5],[-13.42286,-1.98857],[24.87134,3.68464]],[[-312,-174.5],[-7.73414,30.93657],[3.32533,-13.3013]],[[-304,-213.5],[-2.65092,13.25459],[8.55457,-42.77284]],[[-300,-229.5],[-6.13295,18.39884],[0.97183,-2.91548]],[[-298,-238.5],[-0.74536,-2.98142],[5.53018,22.1207]],[[-287,-171.5],[-9.61593,-21.97928],[15.02784,34.34935]],[[-211,-164.5],[-17.2439,39.08618],[14.08602,-31.92831]],[[-189,-261.5],[-5.37338,34.38964],[3.85703,-24.68499]],[[-176,-339.5],[0,25.60179],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-123,-205.5],[0,0],[16.36661,0]],[[-94,-237.5],[28.36487,0],[-1.20769,0]],[[-116,-235.5],[3.93587,-3.37361],[-52.8552,45.30445]],[[-57,-146.5],[-54.45669,36.30446],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[8,-202.5],[0,0],[23.48135,-19.56779]],[[63,-263.5],[-21.65184,29.38464],[19.75564,-26.81122]],[[32,-319.5],[45.97474,-20.22889],[-11.17284,4.91605]],[[11,-289.5],[6.41446,-10.38531],[-28.59861,46.30251]],[[77,-133.5],[-88.62795,70.90236],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[153,-206.5],[0,0],[-23.31916,0]],[[124,-142.5],[-2.10289,-16.82312],[1.45731,11.65848]],[[161,-127.5],[-8.12854,4.80323],[3.81734,-2.2557]],[[182,-144.5],[-5.16379,5.90147],[10.40848,-11.89541]],[[194,-168.5],[-1.64261,13.14092],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[292,-199.5],[0,0],[-13.21576,0]],[[234,-176.5],[5.52934,-19.35271],[-5.92681,20.74383]],[[264,-120.5],[-23.30533,-3.88422],[62.16679,10.36113]],[[276,-195.5],[59.97708,-59.97708],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[363,-197.5],[0,0],[0,7.90204]],[[359,-173.5],[1.33132,-7.76606],[-1.37036,7.99374]],[[355,-149.5],[1.378,-7.99243],[-7.47571,43.35912]],[[385,-215.5],[-22.71706,17.66882],[21.14364,-16.44505]],[418,-163.5],[[416,-184.5],[-1.05566,3.69481],[6.57007,-22.99523]],[[460,-192.5],[-3.89934,-39.96821],[1.07006,10.96811]],[[462,-159.5],[-0.55032,-11.00643],[0.45677,9.13545]],[[460,-134.5],[0,-8.79518],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[499,-183.5],[0,0],[33.94833,0]],[[518,-234.5],[46.24084,-6.30557],[-19.61628,2.67495]],[[488,-156.5],[-7.53019,-19.24382],[4.5442,11.61295]],[[527,-141.5],[-10.05404,-2.23423],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-44,-51.5],[0,0],[0,28.51568]],[[-42,36.5],[-5.61627,-28.08135],[7.0825,35.41252]],[[13,33.5],[-3.96638,27.76469],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-76,-10.5],[0,0],[22.35071,0]],[[-4,-21.5],[-20.71275,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[97,-12.5],[0,0],[-42.65554,0]],[[93,79.5],[-46.54957,9.58373],[31.17931,-6.41927]],[[110,-4.5],[34.91304,9.10775],[-0.83803,-0.21862]],[[87,-6.5],[5.10331,1.61157],[-18.82341,-5.94423]],[[57,-8.5],[19.73426,-5.63836],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-302,119.5],[0,0],[0,27.92927]],[[-305,203.5],[-1.99115,-27.87615],[5.0585,70.81895]],[[-284,413.5],[0,-71.25778],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-299,121.5],[0,0],[50.99302,0]],[[-145,156.5],[-41.29805,-35.10334],[16.54852,14.06624]],[[-122,204.5],[-5.71673,-18.78354],[28.07999,92.26284]],[[-210,383.5],[80.39077,-40.19539],[-7.08065,3.54032]],[[-229,398.5],[6.70066,-3.50987],[-22.0328,11.54099]],[[-284,410.5],[20.97366,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-15,229.5],[0,0],[0,59.5569]],[[-10,408.5],[0,-59.74018],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-15,230.5],[0,0],[4.9431,-4.9431]],[[7,222.5],[-6.63271,0.66327],[32.29903,-3.2299]],[[72,257.5],[-25.03308,10.01323],[13.28998,-5.31599]],[[108,225.5],[-13.36373,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[173,225.5],[0,0],[0,27.12564]],[[174,305.5],[-5.05945,-27.13704],[2.04218,10.95351]],[[192,360.5],[-3.89405,-9.86492],[34.96796,88.5855]],[[310,347.5],[-37.86032,57.90402],[12.18574,-18.63702]],[[333,232.5],[-2.46626,24.66257],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[220,129.5],[0,0],[-23.28659,0]],[[221,154.5],[-25.43731,6.35933],[5.72503,-1.43126]],[[231,144.5],[-1.24503,5.81015],[0.64392,-3.00496]],[[233,135.5],[-0.38118,3.04945],[1.94579,-15.5663]],[[213,128.5],[9.80539,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[295,134.5],[0,0],[-7.83331,0]],[[305,157.5],[-18.51949,9.25975],[3.79136,-1.89568]],[[306,133.5],[4.28183,2.85455],[-2.39814,-1.59876]],[[291,133.5],[2.95753,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-840,-276],[0,0],[0,36.18535]],[[-838,-168],[0,-36.08615],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-838,-224],[0,0],[4.23285,0]],[[-815,-223],[0,-0.21435],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-813,-264],[0,0],[0,26.2308]],[[-810,-186],[0,-26.12357],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-791,-214],[0,0],[0,11.7563]],[[-778,-181],[-18.74222,0],[2.33333,0]],[[-776,-182],[0,1.66667],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-789,-231],[0,0],[0,-3.48659]],[[-792,-229],[7.05122,0],[-2.116,0]],[[-794,-232],[0,1.86964],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-757,-208],[0,0],[0,6.87717]],[[-761,-189],[0,26.4253],[0,-2.33333]],[[-761,-196],[-0.25767,2.31906],[0.42581,-3.83227]],[[-750,-201],[-2.96568,0],[13.75756,0]],[[-740,-174],[0,-11.16335],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-718,-246],[0,0],[0,25.4744]],[[-722,-169],[0,-25.72578],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-733,-223],[0,0],[10.36285,0]],[[-702,-225],[-9.51844,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-687,-206],[0,0],[-4.92455,0]],[[-695,-203],[2.69704,-3.3713],[-16.94093,21.17617]],[[-683,-182],[-1.00349,-3.01048],[2.4483,7.34491]],[[-689,-167],[7.44211,0],[-4.42274,0]],[[-702,-166],[4.40638,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-668,-196],[0,0],[0,-6.56812]],[[-668,-198],[0,3.44271],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-662,-175],[0,0],[6.15454,0]],[[-665,-178],[-8.85335,4.42668],[4.22024,-2.11012]],[[-661,-174],[0,-2.73957],[0,1.33333]],[[-662,-173],[1.33333,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-795,-140],[0,0],[-4.86484,0]],[[-804,-131],[-5.82919,-9.32671],[3.40678,5.45084]],[[-788,-120],[-1.33446,-2.66893],[1.81235,3.6247]],[[-785,-107],[-0.66353,-3.98118],[1.94949,11.69696]],[[-806,-95],[0,1.54435],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-767,-114],[0,0],[-7.9382,0]],[[-760,-87],[-20.19029,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-748,-110],[0,0],[0,5.69497]],[[-749,-93],[0,-5.51486],[0,15.29991]],[[-749,-104],[-4.55235,5.85303],[10.12118,-13.01295]],[[-729,-108],[-6.5668,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-713,-110],[0,0],[-6.38995,0]],[[-721,-87],[-7.28538,-2.42846],[18.94429,6.31476]],[[-714,-113],[22.98551,0],[-2.33333,0]],[[-716,-112],[0,-1.66667],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-685,-110],[0,0],[0,-5.28804]],[[-681,-123],[-0.57722,4.61772],[0.12268,-0.98141]],[[-684,-135],[3.14153,-9.42459],[-5.63749,16.91246]],[[-691,-79],[0,-17.71916],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-668,-105],[0,0],[0,-2.90849]],[[-662,-129],[2.82509,-1.41254],[-8.88142,4.44071]],[[-668,-85],[-5.93186,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-632,-122],[0,0],[0,10.92072]],[[-636,-84],[-3.98281,-11.94842],[0.9678,2.90339]],[[-618,-84],[-1.40183,2.80366],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-644,-110],[0,0],[6.48391,0]],[[-625,-109],[-6.33182,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-603,-106],[0,0],[-6.23307,0]],[[-606,-80],[-4.85315,-2.42658],[12.47645,6.23823]],[[-612,-102],[32.49999,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-559,-136],[0,0],[0,9.62135]],[[-561,-107],[1.46497,-9.52229],[-5.98449,38.89918]],[[-563,-87],[18.23753,-182.37527],[-1.00776,10.07758]],[[-564,-86],[-0.79178,11.48081],[0.62135,-9.00954]],[[-555,-136],[-8.86295,8.86295],[8.42927,-8.42927]],[[-562,-112],[38.93466,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-536,-107],[0,0],[0,0.42776]],[[-545,-94],[0.92216,-2.76647],[-1.52528,4.57584]],[[-533,-76],[-8.72356,8.72356],[4.33358,-4.33358]],[[-530,-103],[0,5.51612],[0,-0.29412]],[-530,-108],[[-530,-102],[0,-2],[0,6.97378]],[[-520,-81],[-9.05152,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-509,-105],[0,0],[0,2.66667]],[[-509,-97],[0.26534,-2.65343],[-0.27351,2.7351]],[[-511,-89],[0.30355,-2.73193],[-1.92282,17.3054]],[[-492,-106],[-19.64417,-9.82209],[9.89574,4.94787]],[[-481,-82],[-16.26498,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-823.5675,-58.4325],[0,0],[-11.01578,0]],[[-832.3875,-33.075],[-6.53118,-8.16398],[9.19488,11.4936]],[[-819.1575,-9.9225],[4.27176,-29.90232],[-0.51563,3.60939]],[[-834.5925,-6.615],[2.6961,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-801.5175,-25.3575],[0,0],[0,17.56963]],[[-791.595,-5.5125],[-16.49072,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-783.8775,-22.05],[0,0],[0,7.35]],[[-783.8775,0],[0,-7.35],[0,2.205]],[[-783.8775,-6.615],[0,2.205],[0,-2.85671]],[[-782.775,-18.7425],[-2.17379,2.17379],[7.24698,-7.24698]],[[-767.34,-19.845],[0,11.06898],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-750.8025,-19.845],[0,0],[-15.04284,15.04284]],[[-741.9825,-8.82],[0,24.66121],[0,-5.49101]],[[-747.495,-16.5375],[7.76886,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-730.9575,-20.9475],[0,0],[0,-0.11076]],[[-724.3425,-40.7925],[2.3093,0],[-6.14744,0]],[[-732.06,3.3075],[-1.6131,-8.0655],[0.21397,1.06983]],[[-729.855,5.5125],[-0.85811,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-717.7275,-15.435],[0,0],[0,-4.28004]],[[-710.01,-29.7675],[-1.3202,4.62069],[0.95532,-3.34364]],[[-715.5225,-37.485],[2.97733,-4.466],[-6.84725,10.27087]],[[-719.9325,1.1025],[0,-12.02012],[0,2.5725]],[[-718.83,3.3075],[-1.8375,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-694.575,-13.23],[0,0],[11.82932,0]],[[-659.295,-9.9225],[-11.43721,-2.8593],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-672.525,-25.3575],[0,0],[0,10.72568]],[[-674.73,6.615],[0,-10.71538],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-642.7575,-19.845],[0,0],[-6.96391,0]],[[-650.475,3.3075],[-5.66161,-5.66161],[9.37323,9.37323]],[[-639.45,-18.7425],[0,3.36256],[0,-1.1025]],[-639.45,-22.05],[[-639.45,-15.435],[0,-2.205],[0,9.99572]],[[-622.9125,3.3075],[-9.75025,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-612.99,-13.23],[0,0],[1.92827,-3.85654]],[[-617.4,-39.69],[14.69194,-7.34597],[-1.31481,0.6574]],[[-617.4,-35.28],[0,-1.47],[0,8.61585]],[[-605.2725,14.3325],[-9.98934,9.98934],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-589.8375,-39.69],[0,0],[0,18.16723]],[[-568.89,1.1025],[-22.21513,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-594.2475,-20.9475],[0,0],[6.74719,0]],[[-575.505,-24.255],[-6.59607,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-608.58,11.025],[0,0],[7.77025,7.77025]],[[-594.2475,7.7175],[-4.73568,4.73568],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-722.1375,30.87],[0,0],[0,17.37046]],[[-707.805,65.0475],[-23.9879,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-733.1625,45.2025],[0,0],[3.82576,0]],[[-716.625,46.305],[-4.35677,1.45226],[2.55738,-0.85246]],[[-714.42,45.2025],[0,-1.70092],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-694.575,45.2025],[0,0],[0,0.63695]],[[-685.755,70.56],[-12.55535,10.04428],[11.57901,-9.26321]],[[-691.2675,47.4075],[14.20962,0],[-1.47,0]],[[-692.37,48.51],[0,-1.47],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-651.5775,50.715],[0,0],[2.94,0]],[[-642.7575,50.715],[-2.94,0],[18.00581,0]],[[-655.9875,68.355],[3.07933,-9.23799],[-1.0421,3.1263]],[[-652.68,72.765],[-2.7426,0],[5.88,0]],[[-635.04,72.765],[-5.88,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-615.195,55.125],[0,0],[-23.59412,0]],[[-625.1175,81.585],[-6.41895,-0.80237],[21.73449,2.71681]],[[-620.7075,56.2275],[22.111,0],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-586.53,56.2275],[0,0],[0,3.675]],[[-586.53,67.2525],[0,-3.675],[0,20.67678]],[[-565.5825,47.4075],[11.55553,11.55553],[-7.57761,-7.57761]],[[-585.4275,65.0475],[0,-6.11123],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]},
{"uid": 1337, "date": 123, "json": ["Path",{"applyMatrix":true,"segments":[[[-555.66,51.8175],[0,0],[0,3.37458]],[[-556.7625,60.6375],[1.15447,-5.77236],[-6.96844,34.8422]],[[-538.02,49.6125],[-17.51551,-5.8385],[4.63108,1.54369]],[[-539.1225,71.6625],[0.65911,0.65911],[-4.37251,-4.37251]],[[-524.79,42.9975],[-3.34321,-1.67161],[4.28888,2.14444]],[[-521.4825,74.97],[0,-4.34909],[0,0]]],"strokeColor":[0,0,0],"strokeWidth":5}]}]});

  				db.insert({"views": { "all": { "map": "function(doc) { if(doc.json) { emit(doc.date, doc.json); }}" } }}, "_design/strokes", function(err, body){ 
  					console.log(body + "::" + err); return; 
  				});

  				
        		return;
      		});
    	});
    	res.send("CLEARED");
  	//}
});

router.put('/new', function(req, res) {
	//if (!req.user){
	//	res.send("FAIL");
	//} else {

		console.log(req.body);
		db.insert({uid: 1111, json: req.body, date: Date.now()}, false, function(err, body) {
			if (!err) {
				res.send(body);
			} else {
				res.send("FAILED: " + err);
			}
		})
	//}
});

module.exports = router;
